node {
  stage('SCM') {
    checkout scm
  }
  stage('SonarQube Analysis') {
    def scannerHome = tool 'SonarScanner';
    withSonarQubeEnv() {
      sh "${scannerHome}/bin/sonar-scanner"
    }
  }
  stage ('DAST') {
     withCredentials([sshUserPrivateKey(credentialsId: 'zap', keyFileVariable: '-----BEGIN OPENSSH PRIVATE KEY-----
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
-----END OPENSSH PRIVATE KEY-----')]) {
       sh 'ssh -o StrictHostKeyChecking=no root@34.125.32.102 "docker run -t owasp/zap2docker-stable zap-baseline.py -t http://34.125.95.251/" '
     }
  }
}
